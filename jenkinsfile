pipeline{
    agent any
      stages {
        stage('clone'){
			steps{
          	git 'https://github.com/patilume/Ant-WebProject.git'
				}
			}
		stage('initialize'){
			steps{
				withAnt(installation: 'ant', jdk: 'jdk') {
				sh 'ant init'
				}
			}
		}
		stage('prepare'){
			steps{
				withAnt(installation: 'ant', jdk: 'jdk') {
				sh 'ant prepare'
				}
			}
		}
		
		stage('compile'){
			steps{
				withAnt(installation: 'ant', jdk: 'jdk') {
				sh 'ant compile'
				}
			}
		}
		
		stage('war'){
			steps{
				withAnt(installation: 'ant', jdk: 'jdk') {
				sh 'ant war'
				}
			}
		}
		
		stage('deploy to tomcat'){
				steps{
					sshagent(['tomcat-deploy']) {
					sh 'scp -o StrictHostKeyChecking=no dist/*.war ec2-user@13.126.225.191:/usr/share/tomcat/webapps/'
					}
				}
			}
	}
}
